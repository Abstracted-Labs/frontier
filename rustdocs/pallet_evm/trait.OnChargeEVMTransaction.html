<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Handle withdrawing, refunding and depositing of transaction fees. Similar to `OnChargeTransaction` of `pallet_transaction_payment`"><title>OnChargeEVMTransaction in pallet_evm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-b1a3e7f8283b8434.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pallet_evm" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0-nightly (ef71f1047 2024-01-21)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-f2adc0d6ca4d09fb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-0b2e2def73e61cbe.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../pallet_evm/index.html">pallet_evm</a><span class="version">6.0.0-dev</span></h2></div><h2 class="location"><a href="#">OnChargeEVMTransaction</a></h2><div class="sidebar-elems"><section><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.LiquidityInfo">LiquidityInfo</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.correct_and_deposit_fee">correct_and_deposit_fee</a></li><li><a href="#tymethod.pay_priority_fee">pay_priority_fee</a></li><li><a href="#tymethod.withdraw_fee">withdraw_fee</a></li></ul><h3><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul class="block"><li><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-()">()</a></li></ul><h3><a href="#object-safety">Object Safety</a></h3><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In crate pallet_evm</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../pallet_evm/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="index.html">pallet_evm</a>::<wbr><a class="trait" href="#">OnChargeEVMTransaction</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/pallet_evm/lib.rs.html#930-951">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait OnChargeEVMTransaction&lt;T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>&gt; {
    type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/default/trait.Default.html" title="trait core::default::Default">Default</a>;

    // Required methods
    fn <a href="#tymethod.withdraw_fee" class="fn">withdraw_fee</a>(
        who: &amp;H160,
        fee: U256
    ) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.correct_and_deposit_fee" class="fn">correct_and_deposit_fee</a>(
        who: &amp;H160,
        corrected_fee: U256,
        base_fee: U256,
        already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>
    ) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.pay_priority_fee" class="fn">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>);
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Handle withdrawing, refunding and depositing of transaction fees.
Similar to <code>OnChargeTransaction</code> of <code>pallet_transaction_payment</code></p>
</div></details><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><section id="associatedtype.LiquidityInfo" class="method"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#931">source</a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/default/trait.Default.html" title="trait core::default::Default">Default</a></h4></section></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.withdraw_fee" class="method"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#935">source</a><h4 class="code-header">fn <a href="#tymethod.withdraw_fee" class="fn">withdraw_fee</a>(who: &amp;H160, fee: U256) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;</h4></section></summary><div class="docblock"><p>Before the transaction is executed the payment of the transaction fees
need to be secured.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.correct_and_deposit_fee" class="method"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#942-947">source</a><h4 class="code-header">fn <a href="#tymethod.correct_and_deposit_fee" class="fn">correct_and_deposit_fee</a>(
    who: &amp;H160,
    corrected_fee: U256,
    base_fee: U256,
    already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>
) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a></h4></section></summary><div class="docblock"><p>After the transaction was executed the actual fee can be calculated.
This function should refund any overpaid fees and optionally deposit
the corrected amount, and handles the base fee rationing using the provided
<code>OnUnbalanced</code> implementation.
Returns the <code>NegativeImbalance</code> - if any - produced by the priority fee.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.pay_priority_fee" class="method"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#950">source</a><h4 class="code-header">fn <a href="#tymethod.pay_priority_fee" class="fn">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>)</h4></section></summary><div class="docblock"><p>Introduced in EIP1559 to handle the priority tip.</p>
</div></details></div><h2 id="object-safety" class="section-header">Object Safety<a href="#object-safety" class="anchor">§</a></h2><div class="object-safety-info">This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#object-safety">object safe</a>.</div><h2 id="foreign-impls" class="section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor">§</a></h2><details class="toggle implementors-toggle"><summary><section id="impl-OnChargeEVMTransaction%3CT%3E-for-()" class="impl"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#1053-1085">source</a><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-()" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="trait.OnChargeEVMTransaction.html" title="trait pallet_evm::OnChargeEVMTransaction">OnChargeEVMTransaction</a>&lt;T&gt; for <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a><div class="where">where
    T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>,
    &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::PositiveImbalance: Imbalance&lt;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;,
    &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance: Imbalance&lt;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::PositiveImbalance&gt;,
    U256: UniqueSaturatedInto&lt;<a class="type" href="type.BalanceOf.html" title="type pallet_evm::BalanceOf">BalanceOf</a>&lt;T&gt;&gt;,</div></h3></section></summary><div class="docblock"><p>Implementation for () does not specify what to do with imbalance</p>
</div><div class="impl-items"><section id="associatedtype.LiquidityInfo-1" class="associatedtype trait-impl"><a href="#associatedtype.LiquidityInfo-1" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&lt;&lt;T as <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>&gt;::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;</h4></section><section id="method.withdraw_fee" class="method trait-impl"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#1066-1071">source</a><a href="#method.withdraw_fee" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.withdraw_fee" class="fn">withdraw_fee</a>(who: &amp;H160, fee: U256) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;</h4></section><section id="method.correct_and_deposit_fee" class="method trait-impl"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#1073-1080">source</a><a href="#method.correct_and_deposit_fee" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.correct_and_deposit_fee" class="fn">correct_and_deposit_fee</a>(
    who: &amp;H160,
    corrected_fee: U256,
    base_fee: U256,
    already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>
) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a></h4></section><section id="method.pay_priority_fee" class="method trait-impl"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#1082-1084">source</a><a href="#method.pay_priority_fee" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.pay_priority_fee" class="fn">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>)</h4></section></div></details><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><details class="toggle implementors-toggle"><summary><section id="impl-OnChargeEVMTransaction%3CT%3E-for-EVMCurrencyAdapter%3CC,+OU%3E" class="impl"><a class="src rightside" href="../src/pallet_evm/lib.rs.html#959-1050">source</a><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-EVMCurrencyAdapter%3CC,+OU%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, C, OU&gt; <a class="trait" href="trait.OnChargeEVMTransaction.html" title="trait pallet_evm::OnChargeEVMTransaction">OnChargeEVMTransaction</a>&lt;T&gt; for <a class="struct" href="struct.EVMCurrencyAdapter.html" title="struct pallet_evm::EVMCurrencyAdapter">EVMCurrencyAdapter</a>&lt;C, OU&gt;<div class="where">where
    T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>,
    C: Currency&lt;&lt;T as Config&gt;::AccountId&gt;,
    C::PositiveImbalance: Imbalance&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = C::NegativeImbalance&gt;,
    C::NegativeImbalance: Imbalance&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = C::PositiveImbalance&gt;,
    OU: OnUnbalanced&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;,
    U256: UniqueSaturatedInto&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance&gt;,</div></h3></section></summary><div class="impl-items"><section id="associatedtype.LiquidityInfo-2" class="associatedtype trait-impl"><a href="#associatedtype.LiquidityInfo-2" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;</h4></section></div></details></div><script src="../trait.impl/pallet_evm/trait.OnChargeEVMTransaction.js" data-ignore-extern-crates="std" async></script></section></div></main></body></html>